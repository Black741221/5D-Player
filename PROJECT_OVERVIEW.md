# 5D-Player 專案技術導覽文件

本文件總結了 5D-Player 專案的技術要點、封包結構、模擬邏輯與系統架構。若日後記憶遭清除，僅憑此檔案亦可快速還原整體設計。

---

## 1️⃣ 語意指令對照表（語言字典）

| 動作         | Param1 | Param2 | 說明                     |
|--------------|--------|--------|--------------------------|
| 全升（UP）   | 00 00  | 0x20   | 全部油壓桿升起           |
| 全降（DOWN） | 00 00  | 0x30   | 全部油壓桿下降           |
| 復位         | 00 00  | 0x10   | 重置控制器狀態           |
| 緊急停止     | 00 00  | 0xFF   | 立即停止一切動作         |
| 油壓桿 1 升  | 00 00  | 0x21   | 控制第一隻油壓桿升起     |
| 油壓桿 1 降  | 00 00  | 0x31   | 控制第一隻油壓桿下降     |
| ...          | ...    | ...    | 油壓桿 2~6 與特效指令略   |

---

## 2️⃣ 封包結構與欄位說明

| 欄位名稱     | 占用欄位        | 範例值        | 說明                     |
|--------------|----------------|----------------|--------------------------|
| Header       | buf[0:2]       | FA 05 01       | 固定開頭                 |
| Param1       | buf[3:4]       | 00 00          | 動作分類                 |
| Param2       | buf[5]         | 0x20           | 動作命令碼               |
| Reserved     | buf[6:9]       | 00 00 00 00    | 預留                     |
| Checksum1    | buf[10]        | 00             | CRC 預留                 |
| Checksum2    | buf[11]        | A0             | XOR 校驗尾段             |

---

## 3️⃣ 原廠封包（Hex Write）分析對照

### 🔹 全升（UP）

```
80 80 ... (重複) ... 00 00 00 5E
```

📌 特徵：只亮 1 號燈，馬達可控

---

### 🔹 全降（DOWN）

```
BF BF ... (重複) ... 3F 3F 00 00 2E
```

📌 特徵：亮燈 1,3,4,5,6,7，多燈號控制

---

## 4️⃣ 模擬器版本演進路線圖

| 版本   | 特徵                                             |
|--------|--------------------------------------------------|
| V1     | 最簡 GUI，只能控制連線與按鍵                    |
| V5     | 完整封包語法模擬（但與原廠封包協議不同）       |
| V6.2   | 加入尾段校驗、Param 映射完成                    |
| V8.1   | 擴充油壓桿 1~6 控制功能                         |
| V8.4   | 加入封包監控模組（ReadMonitor）與 GUI 穩定版  |
| V9 (目標) | 完全模擬原廠 Hex Write 封包時序與控制        |

---

## 5️⃣ GUI 操作規格

- 主操作按鈕：
  - 全升、全降、重置、緊急停止、退出
- 油壓桿 1~6：升起／下降按鈕
- log 輸出區域
- 封包比對警告視窗（ReadMonitor）

---

## 6️⃣ 關鍵模組與功能檔案

| 模組檔名                    | 功能                                 |
|----------------------------|--------------------------------------|
| gui_v8_4.py                | GUI 操作與事件觸發                   |
| command_map_extended.py    | Param2 對應動作語意對照表           |
| slot_packet_simulator.py   | slot → 封包序列化模組                |
| read_monitor.py            | 監控串口封包與比對合法性            |
| packet_builder.c           | 封包欄位生成與初始化邏輯             |
| auth_manager.c             | 原廠封包驗證與比對邏輯段落           |
| hw_control.c               | 低階封包分段與記憶體寫入可能區段     |

---

## 🔚 補充

- 原廠控制板無法被 FA 封包驅動，需改為模擬 Hex Write 串流模式
- 原始封包並非語法協定，而是低階 byte pattern
- 所有行為如「全升只亮一燈、全降亮多燈」皆為實測與行為特徵，非語法可導出

